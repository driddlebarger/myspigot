
<!-- Map container -->
 <div class="container-fluid" style='padding: 0px'>
  	<div id='map' class='map'></div>
    <script>
//  Mapbox GL code 
    mapboxgl.accessToken = 'pk.eyJ1IjoiZHJpZGRsZWJhcmdlciIsImEiOiJjajh3aWhkbDMxczRiMzJvNGQ0azU3NjN5In0.o2fPEeGh3pH2-AeAAR0seQ';
    
      var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/light-v9',
        center: [-118.37, 33.769], // starting position [lng, lat]
        zoom: 11.4 // starting zoom
      });

       map.on('load', function () {

          map.addSource('location', { type: 'geojson', data: 'locations.json' });

          map.loadImage('<%= asset_path('watericon.png') %>', function(error, image) {
              if (error) throw error;
              map.addImage('watericon', image);

              map.addLayer({
                id: 'location',
                type: 'symbol',
                source: 'location',
                layout: {
                    'icon-image': 'watericon',
                    'icon-allow-overlap': true,
                    'icon-size': 0.75
                }

              })

          });

            // When a click event occurs on a feature in the location layer, open a popup at the
            // location of the feature, with description HTML from its properties.    
            map.on('click', 'location', function (e) {
            new mapboxgl.Popup()
              .setLngLat(e.features[0].geometry.coordinates)
              .setHTML(e.features[0].properties.name)
              .addTo(map);  
            });
    
            // Change the cursor to a pointer when the mouse is over the location layer.
            map.on('mouseenter', 'location', function () {
                map.getCanvas().style.cursor = 'pointer';
            });

            // Change it back to a pointer when it leaves.
            map.on('mouseleave', 'location', function () {
                map.getCanvas().style.cursor = '';
            });

            // Add zoom and rotation controls to the map.
            map.addControl(new mapboxgl.NavigationControl());

            // Add geolocation controls to the map.
            map.addControl(new mapboxgl.GeolocateControl({
                positionOptions: {
                enableHighAccuracy: true
                },
                trackUserLocation: true
            }));

      });
  

	
    </script>
</div>  







